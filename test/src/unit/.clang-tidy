# ============================================================
# UNIT TEST CONFIG â€” GoogleTest-specific thresholds
#
# Mirror of the root .clang-tidy with relaxed function
# size/complexity thresholds. Self-contained because the
# workflow uses explicit -config-file= per scope.
#
# MAINTENANCE: when checks or naming rules change in the root
# .clang-tidy, update this file to match. The ONLY intentional
# differences are the three thresholds marked "TEST OVERRIDE".
# ============================================================
---
Checks: >-
  -*,
  bugprone-*,
  -bugprone-easily-swappable-parameters,
  cppcoreguidelines-avoid-goto,
  cppcoreguidelines-init-variables,
  cppcoreguidelines-slicing,
  misc-redundant-expression,
  misc-unused-parameters,
  modernize-use-auto,
  modernize-use-nullptr,
  modernize-use-override,
  performance-*,
  readability-function-cognitive-complexity,
  readability-function-size,
  readability-identifier-naming,
  readability-redundant-smartptr-get,
  readability-simplify-boolean-expr
HeaderFilterRegex: '(src|test)/.*\.h$'
CheckOptions:
  # -- Function complexity (TEST OVERRIDES) ------------------
  # GoogleTest TEST() macros generate TestBody() functions.
  # Data-driven tests (truth tables, struct arrays) need
  # nested loops + conditionals that naturally score 15-25.
  # These thresholds still catch genuinely unreadable tests
  # while not forcing artificial helper extraction.
  readability-function-size.NestingThreshold: 4
  readability-function-size.ParameterThreshold: 5
  readability-function-size.StatementThreshold: 100   # TEST OVERRIDE (src: 50)
  readability-function-size.LineThreshold: 300         # TEST OVERRIDE (src: 200)
  readability-function-cognitive-complexity.Threshold: 25  # TEST OVERRIDE (src: 15)

  # -- Naming (identical to root .clang-tidy) ----------------
  readability-identifier-naming.ClassCase: CamelCase
  readability-identifier-naming.StructCase: CamelCase
  readability-identifier-naming.StructIgnoredRegexp: 'promise_type|t_vpi_.*|s_vpi_.*'
  readability-identifier-naming.EnumCase: CamelCase
  readability-identifier-naming.TypeAliasCase: CamelCase
  readability-identifier-naming.TypeAliasIgnoredRegexp: 'vpiHandle|s_vpi_.*|s_cb_data|SVpi.*|PLI_.*'
  readability-identifier-naming.TypedefCase: CamelCase
  readability-identifier-naming.TypedefIgnoredRegexp: 's_vpi_.*|s_cb_data|sv[A-Z].*|t_vpi_.*|p_vpi_.*|vpi_assertion_callback_func'
  readability-identifier-naming.TemplateParameterCase: CamelCase
  readability-identifier-naming.EnumConstantCase: CamelCase
  readability-identifier-naming.EnumConstantPrefix: k
  readability-identifier-naming.ScopedEnumConstantCase: CamelCase
  readability-identifier-naming.ScopedEnumConstantPrefix: k
  readability-identifier-naming.FunctionCase: CamelCase
  readability-identifier-naming.MethodCase: CamelCase
  readability-identifier-naming.FunctionIgnoredRegexp: 'main|get_return_object|initial_suspend|final_suspend|return_void|return_value|unhandled_exception|await_ready|await_suspend|await_resume|vpi_register_systf|vpi_handle_by_name|vpi_iterate|vpi_scan|vpi_get_value|vpi_put_value|vpi_register_cb|vpi_get|vpi_get_str|vpi_free_object|vpi_get_vlog_info|vpi_register_assertion_cb|sv[A-Z].*'
  readability-identifier-naming.MethodIgnoredRegexp: 'get_return_object|initial_suspend|final_suspend|return_void|return_value|unhandled_exception|await_ready|await_suspend|await_resume|push_back|begin|end|size|empty|data'
  readability-identifier-naming.VariableCase: lower_case
  readability-identifier-naming.ParameterCase: lower_case
  readability-identifier-naming.PrivateMemberCase: lower_case
  readability-identifier-naming.PrivateMemberSuffix: '_'
  readability-identifier-naming.ProtectedMemberCase: lower_case
  readability-identifier-naming.ProtectedMemberSuffix: '_'
  readability-identifier-naming.PublicMemberCase: lower_case
  readability-identifier-naming.ConstantCase: CamelCase
  readability-identifier-naming.ConstantPrefix: k
  readability-identifier-naming.ConstexprVariableCase: CamelCase
  readability-identifier-naming.ConstexprVariablePrefix: k
  readability-identifier-naming.StaticConstantCase: CamelCase
  readability-identifier-naming.StaticConstantPrefix: k
  readability-identifier-naming.ClassConstantCase: CamelCase
  readability-identifier-naming.ClassConstantPrefix: k
  readability-identifier-naming.GlobalConstantCase: CamelCase
  readability-identifier-naming.GlobalConstantPrefix: k
  readability-identifier-naming.LocalConstantCase: CamelCase
  readability-identifier-naming.LocalConstantPrefix: k
  readability-identifier-naming.NamespaceCase: lower_case
